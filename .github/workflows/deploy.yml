name: "Deploy para VPS Windows"
on:
  push:
    branches:
      - main

jobs:
  build_deploy:
    runs-on: windows-latest
    steps:
      - name: "Baixar o código"
        uses: actions/checkout@v4

      - name: "Copiar arquivos para o servidor Windows"
        uses: appleboy/winrm-deploy-action@v0.1.3
        with:
          host: ${{ secrets.HOST_SERVER }}        # Substitua com seu IP ou domínio do servidor
          username: ${{ secrets.EC2_USER }}       # Nome de usuário para autenticação
          password: ${{ secrets.EC2_PASSWORD }}    # Senha para autenticação
          port: 5986                               # Porta do WinRM
          use_https: true                          # Usar HTTPS
          source: "."                              # Pasta de origem (código baixado)
          target: "C:\\xampp\\htdocs"              # Pasta de destino no servidor
          cleanup: false                           # Se deve limpar arquivos no destino
